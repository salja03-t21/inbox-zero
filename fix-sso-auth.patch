--- a/apps/web/utils/auth.ts
+++ b/apps/web/utils/auth.ts
@@ -603,6 +603,19 @@ async function getProfileData(providerId: string, accessToken: string) {
       throw error;
     }
   }
+  
+  // For SSO providers, we can't fetch profile data using access token
+  // The profile data should already be available in the user record
+  if (providerId.includes('okta') || providerId.includes('sso')) {
+    logger.info("[getProfileData] SSO provider detected, returning null", {
+      providerId
+    });
+    return null;
+  }
+  
+  logger.warn("[getProfileData] Unknown provider type", { providerId });
+  
+  return null;
 }
 
 async function handleLinkAccount(account: Account) {
@@ -611,6 +624,31 @@ async function handleLinkAccount(account: Account) {
   let primaryPhotoUrl: string | null | undefined;
 
   try {
+    // For SSO providers, get user info from the user record
+    if (account.providerId.includes('okta') || account.providerId.includes('sso')) {
+      logger.info("[handleLinkAccount] SSO provider detected, getting user info from database", {
+        providerId: account.providerId,
+        userId: account.userId
+      });
+      
+      const user = await prisma.user.findUnique({
+        where: { id: account.userId },
+        select: { email: true, name: true, image: true },
+      });
+      
+      if (!user?.email) {
+        logger.error("[handleLinkAccount] No user email found for SSO provider", {
+          userId: account.userId,
+          providerId: account.providerId,
+        });
+        throw new Error("User email not found for SSO account linking.");
+      }
+      
+      primaryEmail = user.email;
+      primaryName = user.name;
+      primaryPhotoUrl = user.image;
+    } else {
+      // Original OAuth provider logic
     if (!account.accessToken) {
       logger.error(
         "[linkAccount] No access_token found in data, cannot fetch profile.",
@@ -635,6 +673,7 @@ async function handleLinkAccount(account: Account) {
       );
       throw new Error("Primary email not found for linked account.");
     }
+    }
 
     const user = await prisma.user.findUnique({
       where: { id: account.userId },
