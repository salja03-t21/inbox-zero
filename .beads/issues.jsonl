{"id":"inbox-zero-4z2","title":"Clean Onboarding page Server Component error","description":"## Summary\nThe Clean Onboarding page at /[emailAccountId]/clean/onboarding throws a Server Components render error in production. The error message is hidden in production builds for security.\n\n## URL with Error\nhttps://iz.salsven.com/cmi2b38wg0045pi0tqxwi2rve/clean/onboarding?chatId=8c44c8d1-a85d-448b-a689-ef97805c1512\n\n## Error Message\nAn error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.\n\n## Files to Investigate\n- apps/web/app/(app)/[emailAccountId]/clean/onboarding/page.tsx - Main page component\n- apps/web/utils/email/provider.ts - createEmailProvider function\n- apps/web/utils/assess.ts - getUnhandledCount function\n- apps/web/utils/email-account.ts - checkUserOwnsEmailAccount function\n\n## Debugging Steps\n1. Check server logs for the actual error (docker logs)\n2. Add error boundary to catch and log the specific error\n3. Test locally with NODE_ENV=production to reproduce\n4. Check if emailAccountId is valid and user has access\n5. Verify createEmailProvider and getUnhandledCount dont throw\n\n## Possible Causes\n- Email provider creation failing (missing OAuth tokens?)\n- Database query failing\n- Permission check failing silently\n- Props.params/searchParams Promise handling issue","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-18T00:30:47.546934-05:00","updated_at":"2025-12-18T18:14:38.148936-05:00","closed_at":"2025-12-18T18:14:38.148936-05:00","close_reason":"Investigated - related to premium checks. Will be fixed by removing premium requirements."}
{"id":"inbox-zero-8w4","title":"Automation Test tab error and missing History","description":"## Summary\nThe Automation page Test tab shows 'There was an error - An unexpected error occurred' when testing. Additionally, the History tab shows no history entries.\n\n## URLs with Errors\n- Test tab: https://iz.salsven.com/cmi2b38wg0045pi0tqxwi2rve/automation?tab=test\u0026chatId=eec342aa-4f65-4665-b744-3113c8ec807e\n- History tab: https://iz.salsven.com/cmi2b38wg0045pi0tqxwi2rve/automation?tab=history\n\n## Symptoms\n1. Test tab: Shows error modal 'There was an error - An unexpected error occurred'\n2. History tab: No history entries displayed (empty)\n\n## Files to Investigate\n- apps/web/app/(app)/[emailAccountId]/assistant/Process.tsx - Test tab component\n- apps/web/app/(app)/[emailAccountId]/assistant/History.tsx - History tab component\n- Related API routes for testing and history fetching\n\n## Debugging Steps\n1. Check browser Network tab for failed API calls\n2. Check server logs for error details\n3. Verify AI provider configuration (API key, model settings)\n4. Check if rules exist for the email account\n5. Verify database has ExecutedRule entries for history\n\n## Possible Causes\n- AI API key not configured or invalid\n- AI provider endpoint issues\n- Database query errors\n- Missing or misconfigured rules\n- Rate limiting from AI provider","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-18T00:31:10.194256-05:00","updated_at":"2025-12-18T18:14:37.113021-05:00","closed_at":"2025-12-18T18:14:37.113021-05:00","close_reason":"Investigated - these were caused by missing premium status. Will be fixed by removing premium requirements."}
{"id":"inbox-zero-d3d","title":"Linting and Premium Removal Epic","description":"","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-18T18:16:23.17107-05:00","updated_at":"2025-12-18T18:16:23.17107-05:00"}
{"id":"inbox-zero-d3d.1","title":"Fix useUniqueElementIds lint issues - replace static IDs with useId()","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:29.462545-05:00","updated_at":"2025-12-18T18:27:02.028576-05:00","closed_at":"2025-12-18T18:27:02.028581-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.1","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:29.465277-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.2","title":"Fix noUnusedVariables and noUnusedFunctionParameters lint issues","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:32.629718-05:00","updated_at":"2025-12-18T18:16:32.629718-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.2","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:32.633913-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.3","title":"Fix noLabelWithoutControl - associate labels with htmlFor","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:32.955472-05:00","updated_at":"2025-12-18T18:16:32.955472-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.3","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:32.956897-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.4","title":"Fix noExplicitAny - replace any types with proper types","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:36.275322-05:00","updated_at":"2025-12-18T18:16:36.275322-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.4","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:36.295408-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.5","title":"Fix remaining lint issues (imports, ARIA, etc)","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:38.104343-05:00","updated_at":"2025-12-18T18:16:38.104343-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.5","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:38.109801-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6","title":"Remove Premium system - make all features available to all users","description":"","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T18:16:43.776842-05:00","updated_at":"2025-12-18T18:28:06.800496-05:00","closed_at":"2025-12-18T18:28:06.8005-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6","depends_on_id":"inbox-zero-d3d","type":"parent-child","created_at":"2025-12-18T18:16:43.785289-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6.1","title":"Modify hasAiAccess and isPremium to always return true","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T18:16:50.310096-05:00","updated_at":"2025-12-18T18:27:05.50241-05:00","closed_at":"2025-12-18T18:27:05.502421-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6.1","depends_on_id":"inbox-zero-d3d.6","type":"parent-child","created_at":"2025-12-18T18:16:50.314519-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6.2","title":"Remove premium tier checks from database queries","description":"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T18:16:52.372093-05:00","updated_at":"2025-12-18T18:27:53.037151-05:00","closed_at":"2025-12-18T18:27:53.037159-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6.2","depends_on_id":"inbox-zero-d3d.6","type":"parent-child","created_at":"2025-12-18T18:16:52.377739-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6.3","title":"Remove premium upsell UI components and modals","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:53.600028-05:00","updated_at":"2025-12-18T18:16:53.600028-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6.3","depends_on_id":"inbox-zero-d3d.6","type":"parent-child","created_at":"2025-12-18T18:16:53.608601-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6.4","title":"Remove auto-premium creation from auth flow","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T18:16:54.657111-05:00","updated_at":"2025-12-18T18:27:10.589919-05:00","closed_at":"2025-12-18T18:27:10.589925-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6.4","depends_on_id":"inbox-zero-d3d.6","type":"parent-child","created_at":"2025-12-18T18:16:54.662608-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-d3d.6.5","title":"Verify all features work without premium and run tests","description":"","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-18T18:16:56.734574-05:00","updated_at":"2025-12-18T18:16:56.734574-05:00","dependencies":[{"issue_id":"inbox-zero-d3d.6.5","depends_on_id":"inbox-zero-d3d.6","type":"parent-child","created_at":"2025-12-18T18:16:56.742876-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-gdz","title":"Auto-create missing Outlook webhook subscriptions","description":"## Problem\nOutlook/Microsoft email accounts can end up without webhook subscriptions, meaning:\n- Incoming emails don't trigger rules\n- Labels/categories aren't applied\n- The AI assistant doesn't process new emails\n\nThis happens when:\n1. Database is reset but accounts remain\n2. Subscription expires and isn't renewed\n3. Account was created but setup wasn't completed\n\n## Solution\n1. **Inngest cron job**: Periodically scan for accounts missing subscriptions and create them\n2. **UI button**: Allow users to manually re-enable watching from settings\n\n## Security Requirements\n- Only process accounts with `enabled = true`\n- Only process Microsoft provider accounts\n- Rate limit batch processing (max 10/minute)\n- Log all operations for audit trail\n- Handle expired tokens gracefully\n\n## Files to modify\n- `apps/web/utils/inngest/functions/watch-renew.ts` - Add missing subscription check\n- `apps/web/app/(app)/[emailAccountId]/settings/page.tsx` - Add re-enable button\n- `apps/web/utils/outlook/subscription-manager.ts` - May need helper functions","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T16:04:35.771879-05:00","updated_at":"2025-12-18T18:14:33.597109-05:00","closed_at":"2025-12-18T18:14:33.597109-05:00","close_reason":"Completed - Inngest cron function deployed and working. Creates subscriptions for accounts missing them."}
{"id":"inbox-zero-gdz.1","title":"Add Inngest function to create missing Outlook subscriptions","description":"Create an Inngest cron function that:\n1. Runs every 15 minutes\n2. Finds EmailAccounts where:\n   - enabled = true\n   - watchEmailsSubscriptionId IS NULL or empty\n   - account.provider = 'microsoft'\n3. For each account (max 10 per run):\n   - Call createManagedOutlookSubscription()\n   - Log success/failure\n   - Handle token errors gracefully\n\nFile: apps/web/utils/inngest/functions/watch-renew.ts\nAdd new function: createMissingSubscriptions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T16:05:00.640684-05:00","updated_at":"2025-12-18T16:16:32.964864-05:00","closed_at":"2025-12-18T16:16:32.964864-05:00","close_reason":"Implemented createMissingOutlookSubscriptions Inngest cron function in watch-renew.ts. Runs every 15 minutes, finds Microsoft accounts with enabled=true but no subscription, creates up to 10 subscriptions per run. Deployed to personal server.","dependencies":[{"issue_id":"inbox-zero-gdz.1","depends_on_id":"inbox-zero-gdz","type":"parent-child","created_at":"2025-12-18T16:05:00.644947-05:00","created_by":"daemon"}]}
{"id":"inbox-zero-gdz.2","title":"Add UI button to re-enable email watching","description":"Add a button in the settings page that allows users to manually trigger webhook subscription creation.\n\nLocation: apps/web/app/(app)/[emailAccountId]/settings/page.tsx\n\nButton should:\n1. Only show for Microsoft accounts\n2. Show current subscription status (active/missing/expired)\n3. Call API to create/refresh subscription\n4. Show loading state and success/error feedback\n\nMay need new API endpoint: POST /api/user/email-accounts/[id]/watch","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T16:05:10.776746-05:00","updated_at":"2025-12-18T16:05:27.345938-05:00","closed_at":"2025-12-18T16:05:27.345938-05:00","close_reason":"Not needed - user consent is implied by using the app","dependencies":[{"issue_id":"inbox-zero-gdz.2","depends_on_id":"inbox-zero-gdz","type":"parent-child","created_at":"2025-12-18T16:05:10.783165-05:00","created_by":"daemon"}]}
